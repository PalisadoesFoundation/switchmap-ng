"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1133],{3504:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"testing","title":"Testing","description":"Follow the installation steps above to have the application ready, then","source":"@site/docs/testing.md","sourceDirName":".","slug":"/testing","permalink":"/docs/testing","draft":false,"unlisted":false,"editUrl":"https://github.com/PalisadoesFoundation/switchmap-ng/tree/develop/docs/docs/testing.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"Testing","sidebar_label":"Testing","sidebar_position":7},"sidebar":"mainSidebar","previous":{"title":"Community","permalink":"/docs/community"},"next":{"title":"Troubleshooting","permalink":"/docs/troubleshooting"}}');var i=t(4848),r=t(8453);const a={title:"Testing",sidebar_label:"Testing",sidebar_position:7},l="Testing",o={},c=[{value:"Making Your System an SNMP Server",id:"making-your-system-an-snmp-server",level:2},{value:"SwitchMap-NG Setup for Developers",id:"switchmap-ng-setup-for-developers",level:2},{value:"Database Configuration",id:"database-configuration",level:3},{value:"Setup the Test Config File",id:"setup-the-test-config-file",level:3},{value:"API Interactive GraphQL Interaction",id:"api-interactive-graphql-interaction",level:2},{value:"Interactive GraphQL URL",id:"interactive-graphql-url",level:3},{value:"Interactive GraphQL Screenshot",id:"interactive-graphql-screenshot",level:3},{value:"Important File Locations",id:"important-file-locations",level:2},{value:"Module Library Layout",id:"module-library-layout",level:3},{value:"Database and GraphQL",id:"database-and-graphql",level:3},{value:"Run the Test Suite",id:"run-the-test-suite",level:2},{value:"Populating the Database Using the Ingester",id:"populating-the-database-using-the-ingester",level:3},{value:"Running Tests with Coverage Report",id:"running-tests-with-coverage-report",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Run the Frontend Test Suite",id:"run-the-frontend-test-suite",level:2},{value:"Run Tests in Watch Mode",id:"run-tests-in-watch-mode",level:3},{value:"Run Tests with Coverage",id:"run-tests-with-coverage",level:3},{value:"Run a Single Test File",id:"run-a-single-test-file",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"testing",children:"Testing"})}),"\n",(0,i.jsx)(n.p,{children:"Follow the installation steps above to have the application ready, then\nadd these steps for developing code."}),"\n",(0,i.jsx)(n.h2,{id:"making-your-system-an-snmp-server",children:"Making Your System an SNMP Server"}),"\n",(0,i.jsx)(n.p,{children:"Switchmap uses SNMP to gather data from network devices. As a developer it may be difficult to get access to test equipment. This section outlines how to run SNMP on your local machine as an SNMP server."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"When the server is running and correctly configured, it will provide data about its interfaces via SNMP."}),"\n",(0,i.jsx)(n.li,{children:"You'll need to use an SNMP client to extract the data from the server."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Here are some links to get you started:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Windows 11:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["SNMP Server:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Setting up the Server: ",(0,i.jsx)(n.a,{href:"https://blog.paessler.com/how-to-enable-snmp-on-your-operating-system",children:"Enable SNMP on Windows"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["SNMP Client:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Software: ",(0,i.jsx)(n.a,{href:"http://www.net-snmp.org/download.html",children:"Net-SNMP Download"})]}),"\n",(0,i.jsxs)(n.li,{children:["Tutorial: ",(0,i.jsx)(n.a,{href:"https://www.itprc.com/snmpwalk-examples-for-windows/",children:"SNMP Walk Examples for Windows"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Ubuntu:","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["This page includes both server and client setup.","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-an-snmp-daemon-and-client-on-ubuntu-18-04#step-3-configuring-the-snmp-agent-server",children:"Ubuntu SNMP Setup Guide"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Testing configuration example for the ",(0,i.jsx)(n.code,{children:"/etc/snmp/snmpd.conf"})," file.","\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Add this sample SNMPv2 configuration in the ",(0,i.jsx)(n.code,{children:"/etc/snmp/snmpd.conf"})," file adding the community string ",(0,i.jsx)(n.code,{children:"switchmap"})," with the ability to scan the entire SNMP tree.","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"view switchmap-view  included   .1\nrocommunity  switchmap default -V switchmap-view\nrocommunity6 switchmap default -V switchmap-view\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Restart the ",(0,i.jsx)(n.code,{children:"snmpd"})," daemon.","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ systemctl restart snmpd\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Test by running this command.","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ snmpwalk -v2c -c switchmap localhost .1.3.6.1.2.1.2\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["You can get more useful information by commenting out the ",(0,i.jsx)(n.code,{children:"mibs:"})," line in the ",(0,i.jsx)(n.code,{children:"/etc/snmp/snmp.conf"})," file. The output of the previous command will be more complete.","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Contents of file etc/snmp/snmp.conf\n#mibs :\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Run the command again.","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ snmpwalk -v2c -c switchmap localhost .1.3.6.1.2.1.2\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Add these configuration parameters to the ",(0,i.jsx)(n.code,{children:"etc/config.yaml"})," file","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"    zones:\n        - zone: TEST\n        hostnames:\n            - localhost\n\n    snmp_groups:\n\n        - group_name: Localhost-Test\n            snmp_version: 2\n            snmp_secname:\n            snmp_community: switchmap\n            snmp_port: 161\n            snmp_authprotocol:\n            snmp_authpassword:\n            snmp_privprotocol:\n            snmp_privpassword:\n            enabled: True\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["This testing command for the new ",(0,i.jsx)(n.code,{children:"localhost"})," entry will show results.","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo venv/bin/python3 bin/tools/switchmap_poller_test.py --hostname localhost\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"switchmap-ng-setup-for-developers",children:"SwitchMap-NG Setup for Developers"}),"\n",(0,i.jsx)(n.p,{children:"Follow the installation steps above to have the application ready, then\nadd these steps for developing code."}),"\n",(0,i.jsx)(n.h3,{id:"database-configuration",children:"Database Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Create the ",(0,i.jsx)(n.code,{children:"switchmap_unittest"})," database, and grant privileges to a\n",(0,i.jsx)(n.code,{children:"switchmap_unittest"})," user with the password ",(0,i.jsx)(n.code,{children:"switchmap_unittest"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ sudo mysql\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE DATABASE switchmap_unittest;\nGRANT ALL PRIVILEGES ON switchmap_unittest.* TO 'switchmap_unittest'@'localhost' IDENTIFIED BY 'switchmap_unittest';\nFLUSH PRIVILEGES;\nEXIT;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"setup-the-test-config-file",children:"Setup the Test Config File"}),"\n",(0,i.jsxs)(n.p,{children:["Create the testing configuration file which will be stored in a hidden\ndirectory in ",(0,i.jsx)(n.code,{children:"$HOME"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ tests/bin/test_db_config_setup.py\n"})}),"\n",(0,i.jsx)(n.h2,{id:"api-interactive-graphql-interaction",children:"API Interactive GraphQL Interaction"}),"\n",(0,i.jsx)(n.p,{children:"This is useful for:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Developing queries for API clients."}),"\n",(0,i.jsx)(n.li,{children:"Troubleshooting your code."}),"\n",(0,i.jsx)(n.li,{children:"Creating new features."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"On the API server you'll be able to make GraphQL queries in an easy to\nuse interactive web page."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Enter your query in the left hand panel"}),"\n",(0,i.jsxs)(n.li,{children:["Press the ",(0,i.jsx)(n.code,{children:"Play"})," button"]}),"\n",(0,i.jsx)(n.li,{children:"Observe the results"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"interactive-graphql-url",children:"Interactive GraphQL URL"}),"\n",(0,i.jsx)(n.p,{children:"The URL on a running on your local server is:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://localhost:7000/switchmap/api/igraphql",children:"http://localhost:7000/switchmap/api/igraphql"})}),"\n",(0,i.jsx)(n.h3,{id:"interactive-graphql-screenshot",children:"Interactive GraphQL Screenshot"}),"\n",(0,i.jsx)(n.p,{children:"Here is a sample of what to you can do with interactive queries."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image",src:t(7140).A+"",width:"1203",height:"927"})}),"\n",(0,i.jsx)(n.h2,{id:"important-file-locations",children:"Important File Locations"}),"\n",(0,i.jsx)(n.p,{children:"These locations are important for developers:"}),"\n",(0,i.jsx)(n.h3,{id:"module-library-layout",children:"Module Library Layout"}),"\n",(0,i.jsx)(n.p,{children:"Modules are arranged like this:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["The API modules are located in ",(0,i.jsx)(n.code,{children:"switchmap/server"})]}),"\n",(0,i.jsxs)(n.li,{children:["The Poller modules are located in ",(0,i.jsx)(n.code,{children:"switchmap/poller"})]}),"\n",(0,i.jsxs)(n.li,{children:["The Web UI modules are located in ",(0,i.jsx)(n.code,{children:"switchmap/dashboard"})]}),"\n",(0,i.jsxs)(n.li,{children:["Modules that are shared with all three are located in\n",(0,i.jsx)(n.code,{children:"switchmap/core"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"database-and-graphql",children:"Database and GraphQL"}),"\n",(0,i.jsx)(n.p,{children:"Reviewing these files will be important."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["The Database SQLAlchemy ORM definitions can be found in the\n",(0,i.jsx)(n.code,{children:"switchmap/server/db/models.py"})," file."]}),"\n",(0,i.jsxs)(n.li,{children:["The GraphQL schema are located in the\n",(0,i.jsx)(n.code,{children:"switchmap/server/db/schema.py"})," file."]}),"\n",(0,i.jsxs)(n.li,{children:["The GraphQL schema attributes are located in the\n",(0,i.jsx)(n.code,{children:"switchmap/server/db/attributes.py"})," file."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"run-the-test-suite",children:"Run the Test Suite"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"NOTE:"})," The test cases are written to be run only from the root\ndirectory of the repository this to ensure no errors in importing both\nthe required test and code modules."]}),"\n",(0,i.jsx)(n.p,{children:"You can run all the tests with this command."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ cd /path/to/switchmap\n(venv) $ pytest tests/switchmap_\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"You can run individual tests with this command.\n```bash\n(venv) $ cd /path/to/switchmap\n(venv) $ pytest tests/switchmap_/path/to/test.py\n"})}),"\n",(0,i.jsx)(n.h3,{id:"populating-the-database-using-the-ingester",children:"Populating the Database Using the Ingester"}),"\n",(0,i.jsx)(n.p,{children:"Pollers post network data to the Switchmap-NG server. The Ingester\nprocess reads this posted data and uses it to update the database."}),"\n",(0,i.jsx)(n.p,{children:"You may not have access to network devices for testing, however there is\ntest data data that can be imported using the ingester."}),"\n",(0,i.jsx)(n.p,{children:"An easy way to populate the database using this data is to:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Configure switchmap"}),"\n",(0,i.jsxs)(n.li,{children:["Copy the test files in ",(0,i.jsx)(n.code,{children:"tests/testdata_"})," to the configure\n",(0,i.jsx)(n.code,{children:"cache_directory"})]}),"\n",(0,i.jsx)(n.li,{children:"Start or restart the poller daemon or app"}),"\n",(0,i.jsx)(n.li,{children:"The updated data should now be visible in the web UI"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"running-tests-with-coverage-report",children:"Running Tests with Coverage Report"}),"\n",(0,i.jsx)(n.p,{children:"To run the test suite and generate a coverage report, use this command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"(venv) $ cd /path/to/switchmap\n(venv) $ pytest --cov=switchmap --cov-report=lcov:coverage/coverage.lcov --cov-report=term-missing tests/switchmap_\n"})}),"\n",(0,i.jsx)(n.h1,{id:"frontend-testing",children:"Frontend Testing"}),"\n",(0,i.jsxs)(n.p,{children:["Frontend tests for Switchmap-NG are written with ",(0,i.jsx)(n.strong,{children:"Vitest"})," and ",(0,i.jsx)(n.strong,{children:"React Testing Library"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(n.p,{children:"Ensure the frontend dependencies are installed:"}),"\n",(0,i.jsx)(n.h2,{id:"run-the-frontend-test-suite",children:"Run the Frontend Test Suite"}),"\n",(0,i.jsx)(n.p,{children:"Run all frontend tests:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd /path/to/switchmap-ng/frontend\nnpm run test\n"})}),"\n",(0,i.jsx)(n.h3,{id:"run-tests-in-watch-mode",children:"Run Tests in Watch Mode"}),"\n",(0,i.jsx)(n.p,{children:"For active development, run tests in watch mode to automatically rerun tests on file changes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\nnpm run test:watch\n"})}),"\n",(0,i.jsx)(n.h3,{id:"run-tests-with-coverage",children:"Run Tests with Coverage"}),"\n",(0,i.jsx)(n.p,{children:"To generate a coverage report:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\nnpm run test:coverage\n"})}),"\n",(0,i.jsx)(n.p,{children:"The coverage report will be saved under:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\nfrontend/coverage/lcov-report/index.html\n"})}),"\n",(0,i.jsx)(n.p,{children:"Open the report in your browser to inspect test coverage:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\nopen frontend/coverage/lcov-report/index.html\n"})}),"\n",(0,i.jsx)(n.h3,{id:"run-a-single-test-file",children:"Run a Single Test File"}),"\n",(0,i.jsx)(n.p,{children:"To run a specific test file:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm run test -- /path/to/file\n"})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},7140:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/igraphql-screenshot-2a16313a298df3142b459ac76c3a4b61.png"},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var s=t(6540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);